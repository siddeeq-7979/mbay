{% include('shop/layout/header.twig')%}

<!-- Breadcrumb-area -->
<div class="breadcrumb-area bg-gray">
    <div class="container">
        <div class="breadcrumb-content text-center">
            <ul>
                <li><a href="{{BASE_URL}}index">{{lang('home')}}</a></li>
                <li class="active">{{lang('checkout')}}</li>
            </ul>
        </div>
    </div>
</div>
<!-- End Breadcrumb-area -->



<!-- CHECKOUT -->
<section class="checkout-main-area pt-120 pb-120 bg-white">
    <div class="container">

        {{ form_open_multipart('', ' id="shop_checkout_form" name="shop_checkout_form"')|raw }}
        <div class="checkout-wrap pt-30">
            <div class="row">
                <div class="col-lg-7">


                    <!-- CLICK COLLECT & HOME DELIVERY TAB -->
                    <ul class="nav nav-pills nav-fill" id="pills-tab" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="pills-home-tab" data-bs-toggle="pill"
                                    data-bs-target="#pills-home" type="button" role="tab" aria-controls="pills-home"
                                    aria-selected="true" onclick="shopCheckout('click')">
                                {{lang('click_and_collect')}}</button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="pills-profile-tab" data-bs-toggle="pill"
                                    data-bs-target="#pills-profile" type="button" role="tab"
                                    aria-controls="pills-profile" aria-selected="false" onclick="shopCheckout('home')">{{lang('home_delivery')}}</button>
                        </li>

                    </ul>

                    <div class="tab-content" id="pills-tabContent">
                        <div class="tab-pane fade show active" id="pills-home" role="tabpanel"
                             aria-labelledby="pills-home-tab" tabindex="0">
                            <!--click & collect-->

                            <!--store location map-->
                            <iframe
                                src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d532.8177231034424!2d58.19138790642781!3d23.6746034061987!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3e8dfd0a1c0b9a81%3A0xbb048c48328dd216!2zTWF4cGhvbmUgT21hbiAtINmF2YPYsyDZgdmI2YYg2LnZhdin2YY!5e0!3m2!1sen!2som!4v1674372358473!5m2!1sen!2som"
                                width="100%" height="300" style="border:0;" allowfullscreen="" loading="lazy"
                                referrerpolicy="no-referrer-when-downgrade"></iframe>
                            <!--end store location map-->

                            <!--contact details-->
                            {#  <div class="billing-info-wrap mr-50 mt-4">
                                  <h3>{{lang('add_your_contact_details')}}</h3>
                                  <div class="row">
                                      <!--fullname-->
                                      <div class="col-lg-6">
                                          <div class="billing-info mb-20">
                                              <label>{{lang('full_name')}}<abbr class="required"
                                                  title="required">*</abbr></label>
                                              <input type="text">
                                          </div>
                                      </div>
                                      <!--end fullname-->
                                      <!--mobile number-->
                                      <div class="col-lg-6">
                                          <div class="billing-info mb-20">
                                              <label>{{lang('mobile_number')}}<abbr class="required"
                                                      title="required">*</abbr></label>
                                              <input type="text">
                                          </div>
                                      </div>
                                      <!--end mobile number-->
                                  </div>
                                  <div class="row">
                                      <!--email-->
                                      <div class="col-lg-6">
                                          <div class="billing-info mb-20">
                                              <label>{{lang('email')}}</label>
                                              <input type="text">
                                          </div>
                                      </div>
                                      <!--end email-->
                                  </div>
                              </div>#}
                            <!--end contact details-->

                            <!--end click & collect-->
                        </div>

                        <div class="tab-pane fade" id="pills-profile" role="tabpanel"
                             aria-labelledby="pills-profile-tab" tabindex="0">
                            <!--home delivery-->
                            <div class="billing-info-wrap mr-50">
                                <h3>{{lang('choose_shipping_address')}}</h3>
                                <div class="row">


                                <div class="card" >
                                    <div class="card-body py-0">
                                     {% set first = 1 %}
                                     {% for address in user_address %}
                                    
                                        <div class="pane py-3 border-bottom">
                                            <div>
                                                <div class="d-flexx">
                                                    <input class="custom-check-input cstm-inppt" type="radio" name="chooseAddress"  {% if first == 1 %} checked {% endif %} value="{{address.address_id}}" id="defaultCheck1" />
                                                    <label class="custom-check-label" for="defaultCheck1"> </label>
                                                    <div class="card-title my-0 h6">
                                                    {{address.fullname}}<br/>
                                                    {{address.address_1}}<br/>
                                                    {{address.address_2}}<br/>
                                                    {{address.city}}<br/>
                                                    {{address.state_name}}<br/>
                                                    {{address.country_name}}<br/>
                                                    {{address.zip_code}}<br/>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                         {% set first = 0 %}
                                     {% endfor %}

                                        <div class="pane py-3">
                                        <div>
                                            <h2 class="card-title my-0 mb-2 h6"><a href="account/3"> {{lang('add_new_address')}} </a></h2>
                                        </div>
                                        </div>
                                    </div>
                                </div>


                                    {# <div class="col-lg-12">
                                        <div class="billing-info mb-20">
                                            <label>{{lang('address_1')}}<abbr
                                                    class="required" title="required">*</abbr></label>
                                            <input type="text" id="address_1" name="address_1" value="{{user_details.address_1}}">
                                        </div>
                                    </div>

                                    <div class="col-lg-12">
                                        <div class="billing-info mb-20">
                                            <label>{{lang('address2')}}<abbr class="required" title="required">*</abbr></label>
                                            <input type="text" id="address_2" name="address_2" value="{{user_details.address_2}}">
                                        </div>
                                    </div>

                                    <div class="col-lg-12">
                                        <div class="billing-info mb-20">
                                            <label>{{lang('city')}}<abbr class="required" title="required">*</abbr></label>
                                            <input type="text" id="city" name="city" value="{{user_details.city}}">
                                        </div>
                                    </div>

                                    <div class="col-lg-12">
                                        <div class="billing-select mb-20">
                                            <label>{{lang('country')}} <abbr class="required" title="required">*</abbr></label>
                                            <select type="text" name="country" id="country">
                                                <option value="">{{lang('select+your_country')}}</option>
                                                {% for cntrs in countries %}
                                                    <option value="{{cntrs.id}}" {% if user_details.country==cntrs.id %} selected {% endif %}>{{cntrs.name}}</option>
                                                {% endfor %}

                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-lg-12">
                                        <div class="billing-select mb-20">
                                            <label>{{lang('state')}} <abbr class="required" title="required">*</abbr></label>
                                            <span id="state_span">
                                                <select type="text" name="state" id="state">
                                                    <option value="">{{lang('select_your_state')}}</option>
                                                    {% for state in states %}
                                                        <option value="{{state.id}}" {% if user_details.state==state.id %} selected {% endif %}>{{state.name}}</option>
                                                    {% endfor %}

                                                </select>
                                            </span>
                                        </div>
                                    </div>

                                    <div class="col-lg-12">
                                        <div class="billing-info mb-20">
                                            <label>{{lang('zip_code')}}<abbr class="required"
                                                                 title="required">*</abbr></label>
                                            <input type="text" id="zip_code" name="zip_code" value="{{user_details.zip_code}}">
                                        </div>
                                    </div>

                                    <h4 class="mb-3 mt-2">{{lang('personal_information')}}</h4>

                                    <div class="col-lg-12">
                                        <div class="billing-info mb-20">
                                            <label>{{lang('full_name')}}</label>
                                            <input type="text" id="fullname" name="fullname" value="{{user_details.fullname}}">
                                        </div>
                                    </div>
                                    <div class="col-lg-12">
                                        <div class="billing-info mb-20">
                                            <label>{{lang('mobile_number')}}<abbr class="required" title="required">*</abbr></label>
                                            <input type="text" id="phone_number" name="phone_number" value="{{user_details.phone_number}}">
                                        </div>
                                    </div>
                                    
                                    <div class="col-lg-12">
                                        <input type="hidden"  id="address_type" name="inlineRadioOptions">
                                        <div class="mb-3">
                                            <label class="d-block mb-2">{{lang('address_type')}} <span
                                                    class="text-muted">(optional)</span></label>

                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input" type="radio"
                                                       name="inlineRadioOptions" id="inlineRadio1" value="Home">
                                                <label class="form-check-label" for="inlineRadio1">{{lang('home')}}</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input" type="radio"
                                                       name="inlineRadioOptions" id="inlineRadio2" value="Office">
                                                <label class="form-check-label"
                                                       for="inlineRadio2">{{lang('office')}}</label>
                                            </div>

                                        </div>

                                    </div> #}

                                </div>
                            </div>
                        </div>
                    </div>


                </div>

                <div class="col-lg-5">
                    <div class="your-order-area">
                        <h3>{{lang('your_order_summary')}}</h3>
                        {% for car in cart %}
                            <div class="your-order-wrap gray-bg-4">
                                <div class="your-order-info-wrap">

                                    <div class="summary-item-main d-none d-sm-none d-md-none d-lg-block">
                                        <!--summary loop items-->
                                        <div class="d-flex">
                                            <div class="flex-shrink-0">
                                                <img src="assets/shop/images/product/{{car.image}}" alt="">
                                            </div>

                                            
                                            <div class="flex-grow-1 ms-3">
                                                <h5>{{car.name}}</h5>
                                                <!-- <p>Colour: <span>Grey</span></p> -->
                                                <div
                                                    class="d-flex-price justify-content-between align-items-center">
                                                    <p>Qty: <span>{{car.qty}}</span></p>
                                                    <p>{{lang('')}}: <span class="fw-semibold">OMR &nbsp;{{car.price}}</span></p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
<!-- 
                                    <div class="your-order-info order-shipping">
                                        <ul>
                                            <li>Price ({{car.qty}} items) <span class="fw-semibold">OMR &nbsp;{{car.subtotal}} </span></li>
                                          
                                        </ul>
                                    </div> -->
                                    <!-- <div class="your-order-info order-total b-top-dashed"> -->
                                        <!-- <ul> -->
                                           <!--  <li class="fw-semibold">PRICE <span class="fw-semibold">OMR
                                                    &nbsp;{{car.subtotal}} </span></li> -->
                                        <!-- </ul> -->
                                    <!-- </div> -->
                                </div>&nbsp;


                            {% endfor %}
                                    <div class="your-order-info order-total b-top-dashed sub-total-block"> 
                                        <ul>
                                            <li class="fw-semibold1">{{lang('sub_total')}}<span class="fw-semibold1" >OMR &nbsp;{{cart_amount|number_format(2, '.', ',')}} </span></li>
                                        </ul>
                                        <ul>
                                            <li class="fw-semibold1">{{lang('dicount')}} <span class="fw-semibold1" >OMR &nbsp;{{cart_amount*0.01|number_format(2, '.', ',')}} </span></li>
                                        </ul>
                                     </div> 
                                    <div class="your-order-info order-total b-top-dashed"> 
                                        <ul>
                                            <li class="fw-semibold">{{lang('total_payable')}} <span class="fw-semibold" id="cart-amount">OMR &nbsp;{{cart_amount *0.99|number_format(2, '.', ',')}} </span></li>
                                        </ul>
                                     </div> 


                                <!--payment-->
                                <div class="payment-method">

                                    <!-- cash on delivery -->
                                    <div class="pay-top sin-payment">
                                        <input id="payment_method_1" class="radio-inline" type="radio" value="cash_on_delivery" checked ="checked"
                                                name="payment_type">
                                        <label for="payment_method_1">{{lang('cash_on_delivery')}} </label>
                                        <div class="payment-box payment_method_bacs">
                                            <p>Make your payment directly into our bank account. Please use your
                                                Order ID as the payment reference.</p>
                                        </div>
                                    </div>
                                    <!-- end cash on delivery -->



                                    <!-- payment gateway -->
                                 <!--  <div class="pay-top sin-payment sin-payment-3">
                                        <input id="payment_method_2" class="input-radio" type="radio" value="Thawani"
                                               name="payment_type">
                                        <label class="d-block" for="payment_method_2">Pay with Visa or Master Card Through Thawani Gate <img src="assets/shop/images/icon-img/payment.png" alt="">
                                        <a href="https://thawani.om/about/" target="_blank">What is
                                                Thawani?</a></label>
                                        {# <div class="payment-box payment_method_bacs">
                                            <p>
                                            Make your payment directly into our bank account. Please use your
                                                Order ID as the payment reference.
                                                </p>
                                        </div> #}
                                    </div> -->
                                    <!-- end payment gateway -->

                                    <!-- direct bank transfer -->
                                    <div class="pay-top sin-payment">
                                         <input id="payment_method_3" class="radio-inline" type="radio" value="bank_transfer" name="payment_type">
                                         <label for="payment_method_3"> {{lang('direct_bank_transfer')}} </label>
                                         <div class="payment-box payment_method_bacs">
                                             <p>
                                             Make your payment directly into our bank account, and please use your Order ID as the payment reference. After uploading your payment screenshot, the admin will verify your order.
                                             </p>
                                               <!-- <div class="d-flex justify-content-center align-items-center height-80 width-80 rounded border p-1"> -->
                                                   <img src="assets/images/qrcode.png" class="img-responsive" alt="">

                                               <!-- </div> -->
                                             <div class="bank-account-details border rounded p-3 mt-2">
                                                 <address class="mb-0">
                                                <strong>Bank Name</strong><br>
                                                Bank Muscat<br>
                                                <strong>Company Name</strong><br>
                                                Al Osan Complete Enterprises LLC <br>
                                                <strong>A/C NO  </strong><br>
                                                0314055619700019<br>
                                                </address>
                                             </div>
                                             <div class="mt-2 clearfix">
                                                            <span class="fileupload-new"><i class="fa fa-folder-open-o"></i> {{lang('upload_payment_slip')}}</span>
                                                            <span class="fileupload-exists"><i class="fa fa-folder-open-o"></i> </span>
                                                            <input type="file" class="file-input" name="document" id='document' tabindex='2'>

                                                        </div>
                                                <!--  <div class="mt-2 clearfix">
                                                    <label for="formFile" class="form-label m-0">Upload Payment Slip</label>
                                                    <input class="form-control form-control-sm" type="file" id="formFile">
                                                 </div> -->
                                         </div>
                                     </div>
                                    <!-- end direct bank transfer --> 
                                </div>
                                <!--end payment-->

                        </div>
                        {#                        <input type="hidden" name="checkout_type" id="checkout_type">
                        #}                           
                        <button type="submit"class="btn btn-primary" value="shop_checkout_click" name="shop_checkout" id="shop_checkout">{{lang('place_order')}}<i class="fa fa-arrow-circle-right"></i>
                        </button>  

                        {# <button type="submit"class="btn btn-primary" value="shop_checkout_home" name="shop_checkout" id="shop_checkout_home">{{lang('place_order')}}<i class="fa fa-arrow-circle-right"></i>
                        </button>   #}


                        {# <div class="place-order">
                             <a href="#">{{lang('place_order')}}</a>
                         </div>#}
                    </div>
                </div>
            </div>
        </div>

        {{ form_close()|raw }}  

    </div>
</section>
<!-- END CHECKOUT -->

{% include('shop/layout/footer.twig')%}
<script src="assets/plugins/select2/select2.min.js"></script>
<script src="assets/js/form-elements.js"></script>
<script>
    function shopCheckout(type) {
        

        total ={{cart_amount}}
        if (type == 'home') {
                $('.sub-total-block').hide();
                $('#cart-amount').html('OMR '+total.toFixed(2).toLocaleString('en-US'));
                $('#shop_checkout').val('shop_checkout_home');
        }else if(type == 'click'){
                $('.sub-total-block').show();
                $('#cart-amount').html('OMR '+ (total*0.99).toFixed(2).toLocaleString('en-US'));
                $('#shop_checkout').val('shop_checkout_click');
        }
    }

    $('#country').on('change', function (e) {
        var optionSelected = $("option:selected", this);
        var valueSelected = this.value;

        $.ajax({url: "register/get_states",
            data: {country_id: valueSelected},
            async: false,
            success: function (msg) {
                $('#state_span').html(msg);
                $("#state").select2({
                    placeholder: "Select a State",
                    allowClear: false
                });
            }
        });

    });
</script>
<style>
.cstm-inppt{
    width:auto!important;
    margin-right:15px
}.d-flexx{
    display:flex;
}
</style>